---
title: "code"
format: html
---

```{r}
# Load the packages
library(httr)
library(base64enc)

# Set your Spotify API credentials
client_id <- "a55a11bb77454560aaccf3d89fd09027"
client_secret <- "9510178f564b4b69a3aaf78e4a7d099f"

token <- get_token(client_id, client_secret)
#print (token)
auth_header <- get_auth_header(token)
search_spotify_artist(token, "BeyoncÃ©")

```

```{r}
library(httr)
library(jsonlite)
library(base64enc)

get_token <- function(client_id, client_secret) {
  # Encode client ID and secret
  auth_string <- paste0(client_id, ":", client_secret)
  auth_base64 <- base64encode(charToRaw(auth_string))
  
  # Prepare request
  url <- "https://accounts.spotify.com/api/token"
  headers <- add_headers(
    Authorization = paste("Basic", auth_base64),
    `Content-Type` = "application/x-www-form-urlencoded"
  )
  body <- list(grant_type = "client_credentials")
  
  # Send POST request
  response <- POST(url, headers, body = body, encode = "form")
  content <- content(response, as = "text", encoding = "UTF-8")
  print (content)
  token <- fromJSON(content)$access_token
  
  return(token)
}

get_auth_header <- function(token) {
  return(add_headers(Authorization = paste("Bearer", token)))
}

```

```{r}
search_spotify_artist <- function(token, artist_name) {
  url <- paste0('https://api.spotify.com/v1/search?q=', URLencode(artist_name), '&type=artist&limit=1')
  response <- httr::GET(
    url, 
    httr::add_headers(Authorization = paste('Bearer', token))
  )
  content <- httr::content(response, "parsed")
  
  print(content)
}
```

```

